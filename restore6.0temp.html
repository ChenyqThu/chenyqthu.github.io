<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>6.0ä¸´æ—¶ç‰ˆæœ¬ Controller Restore æµç¨‹å›¾</title>

  <!-- TailwindCSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Ant Design CSS -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/antd/5.12.8/antd.min.css" rel="stylesheet">

  <!-- Mermaid -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.6.1/mermaid.min.js"></script>
</head>
<body class="bg-gray-50 text-gray-800">
  <div class="max-w-7xl mx-auto p-6">
    <h1 class="text-2xl md:text-3xl font-semibold text-slate-800 text-center mb-6">6.0 ä¸´æ—¶ç‰ˆæœ¬ Controller Restore æµç¨‹å›¾</h1>
    <p class="text-center text-slate-600 mb-8">ç®€åŒ–ç‰ˆæœ¬ï¼šç§»é™¤å¤æ‚ç¡®è®¤æµç¨‹ï¼Œè¿ç§»åˆå¹¶åœºæ™¯æš‚ä¸æ”¯æŒ</p>

    <!-- æµç¨‹å›¾ -->
    <div class="bg-white rounded-xl border border-slate-200 shadow-sm p-4 md:p-6">
      <div class="mermaid">
        flowchart TD
            Start([ç”¨æˆ·ç‚¹å‡» Restore]) --> Upload[é€‰æ‹©å¹¶ä¸Šä¼ å¤‡ä»½æ–‡ä»¶]
            Upload --> Warning[é€šç”¨é£é™©æç¤ºå¼¹çª—<br/>å«å¤‡ä»½ä¸‹è½½é€‰é¡¹]
            Warning --> UserChoice{ç”¨æˆ·é€‰æ‹©}
            UserChoice -->|ä¸‹è½½å¤‡ä»½åç»§ç»­| Continue[ç»§ç»­ Restore]
            UserChoice -->|ç›´æ¥ç»§ç»­| Continue
            UserChoice -->|å–æ¶ˆ| Cancel([å–æ¶ˆæ“ä½œ])
            
            Continue --> ServerProcess[åç«¯è§£å¯†å¹¶è§£ææ–‡ä»¶]
            ServerProcess --> ParseCheck{æ–‡ä»¶è§£æçŠ¶æ€}
            ParseCheck -->|è§£æå¤±è´¥| ParseError[æ˜¾ç¤ºè§£æé”™è¯¯]
            ParseError --> Cancel
            
            ParseCheck -->|è§£ææˆåŠŸ| IDCheck[Controller ID æ¯”å¯¹]
            IDCheck --> RiskAssess{é£é™©è¯„ä¼°}
            
            RiskAssess -->|ã€Controller å›æ»šåœºæ™¯ã€‘<br/>ç›¸åŒController| Rollback[Controller å›æ»š]
            Rollback --> RollbackProgress[æ˜¾ç¤ºå›æ»šè¿›åº¦]
            RollbackProgress --> Complete([æ“ä½œå®Œæˆ])
            
            RiskAssess -->|ã€Controller è¿ç§»åˆå¹¶åœºæ™¯ã€‘<br/>ä¸åŒController<br/>ä¸”æœ‰ç®¡ç†è®¾å¤‡| MergeBlock[ğŸš« è¿ç§»åˆå¹¶æš‚ä¸æ”¯æŒ]
            MergeBlock --> BlockWarning[å¼ºåˆ¶ä¸­æ–­è­¦å‘Šå¼¹çª—]
            BlockWarning --> Cancel
            
            RiskAssess -->|ã€Controller å…¨æ–°è¿ç§»åœºæ™¯ã€‘<br/>ä¸åŒController<br/>ä¸”æ— ç®¡ç†è®¾å¤‡| FreshMigration[Controller å…¨æ–°è¿ç§»]
            FreshMigration --> MigrationProgress[æ˜¾ç¤ºè¿ç§»è¿›åº¦]
            MigrationProgress --> Complete
            
            classDef safe fill:#e8f5e8,stroke:#4caf50,stroke-width:2px
            classDef warning fill:#fff3cd,stroke:#ffc107,stroke-width:2px
            classDef blocked fill:#f8d7da,stroke:#dc3545,stroke-width:2px
            classDef process fill:#e3f2fd,stroke:#2196f3,stroke-width:2px
            classDef decision fill:#f3e5f5,stroke:#9c27b0,stroke-width:2px
            classDef startEnd fill:#e1f5fe,stroke:#0277bd,stroke-width:3px
            
            class Rollback,RollbackProgress,FreshMigration,MigrationProgress safe
            class Warning warning
            class MergeBlock,BlockWarning blocked
            class ServerProcess,IDCheck process
            class UserChoice,ParseCheck,RiskAssess decision
            class Start,Cancel,Complete startEnd
      </div>
    </div>

    <!-- æµç¨‹è¯´æ˜ -->
    <div class="mt-6">
      <h3 class="text-slate-700 font-medium mb-3">ä¸‰ç§åœºæ™¯è¯´æ˜</h3>
      <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
        <!-- Controller å›æ»š -->
        <div class="rounded-lg border border-green-200 bg-green-50 p-4">
          <div class="flex items-center gap-2 mb-2">
            <div class="w-4 h-4 rounded-sm bg-green-400"></div>
            <div class="text-sm font-semibold text-green-800">Controller å›æ»š</div>
          </div>
          <div class="text-xs text-green-700 leading-relaxed">
            ç›¸åŒController IDï¼Œå®‰å…¨çš„é…ç½®æ¢å¤æ“ä½œ
          </div>
        </div>
        
        <!-- Controller å…¨æ–°è¿ç§» -->
        <div class="rounded-lg border border-blue-200 bg-blue-50 p-4">
          <div class="flex items-center gap-2 mb-2">
            <div class="w-4 h-4 rounded-sm bg-blue-400"></div>
            <div class="text-sm font-semibold text-blue-800">Controller å…¨æ–°è¿ç§»</div>
          </div>
          <div class="text-xs text-blue-700 leading-relaxed">
            ä¸åŒController IDï¼Œä½†å½“å‰æ— ç®¡ç†è®¾å¤‡ï¼Œå¯ç›´æ¥è¿ç§»
          </div>
        </div>
        
        <!-- Controller è¿ç§»åˆå¹¶ -->
        <div class="rounded-lg border border-red-200 bg-red-50 p-4">
          <div class="flex items-center gap-2 mb-2">
            <div class="w-4 h-4 rounded-sm bg-red-400"></div>
            <div class="text-sm font-semibold text-red-800">Controller è¿ç§»åˆå¹¶</div>
          </div>
          <div class="text-xs text-red-700 leading-relaxed">
            ä¸åŒController IDï¼Œä¸”å½“å‰æœ‰ç®¡ç†è®¾å¤‡ï¼Œ6.0ç‰ˆæœ¬æš‚ä¸æ”¯æŒ
          </div>
        </div>
      </div>
    </div>

    <!-- ç®€åŒ–ç‰ˆé€šç”¨é£é™©æç¤º -->
    <div class="mt-10 rounded-xl border border-slate-200 bg-white p-5 md:p-6">
      <h2 class="text-xl font-semibold text-slate-800 mb-4">ç®€åŒ–ç‰ˆé€šç”¨é£é™©æç¤ºå¼¹çª—</h2>

      <div class="bg-slate-50 rounded-lg p-6 md:p-8">
        <div class="flex justify-center items-center">
          <div class="relative w-[680px] max-w-[92vw] bg-white rounded-lg shadow-xl border border-slate-200">
            <!-- Header -->
            <div class="px-5 py-3 border-b border-slate-100 flex items-center gap-3">
              <div class="text-xl">âš ï¸</div>
              <h3 class="m-0 text-base font-semibold text-orange-600">Configuration Restore Warning</h3>
            </div>

            <!-- Body -->
            <div class="p-5">
              <!-- è­¦ç¤ºä¿¡æ¯ -->
              <div class="rounded-md border border-orange-200 bg-orange-50 p-4 mb-4">
                <p class="m-0 text-sm font-medium text-orange-800 mb-2">
                  You are about to restore a configuration backup. This operation will:
                </p>
                <ul class="mt-2 text-sm text-orange-800 space-y-1 ml-4">
                  <li>â€¢ Overwrite current controller configuration</li>
                  <li>â€¢ Potentially affect managed devices</li>
                  <li>â€¢ Cannot be undone without a backup</li>
                </ul>
              </div>

              <!-- å¤‡ä»½æ¨è -->
              <div class="rounded-md border border-blue-200 bg-blue-50 p-4">
                <div class="flex items-center gap-2 mb-3 text-blue-700 text-sm font-medium">
                  <span>ğŸ’¾</span><span>Recommended: Download current backup first</span>
                </div>
                <button
                  class="ant-btn ant-btn-primary w-full mb-2 inline-flex items-center justify-center gap-2 rounded-md shadow-sm
                         bg-blue-600 text-white border border-blue-600 hover:bg-blue-500 hover:border-blue-500
                         focus:outline-none focus:ring-2 focus:ring-blue-400 h-10"
                >
                  <span class="text-base">ğŸ“¥</span>
                  <span>Download Current Backup</span>
                </button>
                <p class="m-0 text-xs text-slate-500 text-center">Save current configuration before proceeding</p>
              </div>
            </div>

            <!-- Footer -->
            <div class="px-5 py-3 border-t border-slate-100 flex justify-end gap-2">
              <button
                class="ant-btn ant-btn-default inline-flex items-center justify-center px-4 py-2 rounded-md
                       border border-slate-300 bg-white text-slate-700 shadow-sm
                       hover:bg-slate-50 hover:border-slate-400
                       focus:outline-none focus:ring-2 focus:ring-blue-400"
              >
                Cancel
              </button>

              <button
                class="ant-btn ant-btn-primary inline-flex items-center justify-center px-4 py-2 rounded-md
                       border border-orange-600 bg-orange-600 text-white shadow-sm
                       hover:bg-orange-500 hover:border-orange-500
                       focus:outline-none focus:ring-2 focus:ring-orange-400"
              >
                Continue Restore
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- è¿ç§»åˆå¹¶é˜»æ­¢è­¦å‘Šå¼¹çª— -->
    <div class="mt-10 rounded-xl border border-slate-200 bg-white p-5 md:p-6">
      <h2 class="text-xl font-semibold text-slate-800 mb-4">è¿ç§»åˆå¹¶é˜»æ­¢è­¦å‘Šå¼¹çª—</h2>

      <div class="bg-slate-50 rounded-lg p-6 md:p-8">
        <div class="flex justify-center items-center">
          <div class="relative w-[720px] max-w-[92vw] bg-white rounded-lg shadow-2xl border border-red-200">
            <!-- Header -->
            <div class="px-5 py-3 border-b border-red-100 flex items-center gap-3 bg-red-50">
              <div class="text-xl">ğŸš«</div>
              <h3 class="m-0 text-base font-semibold text-red-600">Controller Migration Not Supported</h3>
            </div>

            <!-- Body -->
            <div class="p-5">
              <!-- é˜»æ­¢ä¿¡æ¯ -->
              <div class="rounded-md border border-red-300 bg-red-50 p-4 mb-4">
                <div class="flex items-start gap-3">
                  <div class="text-red-500 text-lg mt-0.5">âš ï¸</div>
                  <div>
                    <p class="m-0 text-sm font-bold text-red-800 mb-2">Operation Blocked: Controller Migration with Managed Devices</p>
                    <div class="text-sm text-red-700 space-y-1">
                      <div>â€¢ <strong>Source Controller:</strong> Controller-AAA-1234</div>
                      <div>â€¢ <strong>Target Controller:</strong> Controller-BBB-5678</div>
                      <div>â€¢ <strong>Managed Devices:</strong> <strong class="text-red-800">23 devices currently managed</strong></div>
                      <div>â€¢ <strong>Status:</strong> Migration between different controllers with existing managed devices is not supported in this version</div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- è§£å†³æ–¹æ¡ˆå»ºè®® -->
              <div class="rounded-md border border-blue-200 bg-blue-50 p-4">
                <div class="flex items-start gap-3">
                  <div class="text-blue-500 text-lg mt-0.5">ğŸ’¡</div>
                  <div>
                    <p class="m-0 text-sm font-medium text-blue-800 mb-2">To perform controller migration:</p>
                    <div class="text-sm text-blue-700 space-y-1">
                      <div>1. Forget all managed devices from the current controller</div>
                      <div>2. Ensure the controller has no managed devices</div>
                      <div>3. Then retry the restore operation</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Footer -->
            <div class="px-5 py-3 border-t border-slate-100 flex justify-end gap-2">
              <button
                class="ant-btn ant-btn-primary inline-flex items-center justify-center px-4 py-2 rounded-md
                       border border-blue-600 bg-blue-600 text-white shadow-sm
                       hover:bg-blue-500 hover:border-blue-500
                       focus:outline-none focus:ring-2 focus:ring-blue-400"
              >
                OK
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- æŠ€æœ¯å®ç°è¯´æ˜ -->
    <div class="mt-10 rounded-xl border border-slate-200 bg-white p-5 md:p-6">
      <h2 class="text-xl font-semibold text-slate-800 mb-4">6.0 ç‰ˆæœ¬æŠ€æœ¯å®ç°è¦ç‚¹</h2>
      
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
          <h3 class="text-lg font-medium text-slate-700 mb-3">åç«¯é£é™©è¯„ä¼°é€»è¾‘</h3>
          <div class="bg-slate-100 rounded-md p-4 font-mono text-sm">
            <div class="text-green-600">// ç®€åŒ–çš„é£é™©è¯„ä¼°</div>
            <div class="text-slate-800">if (source_id === current_id) {</div>
            <div class="text-slate-800 ml-4">return "ROLLBACK";</div>
            <div class="text-slate-800">} else if (managed_devices > 0) {</div>
            <div class="text-slate-800 ml-4">return "BLOCKED";</div>
            <div class="text-slate-800">} else {</div>
            <div class="text-slate-800 ml-4">return "FRESH_MIGRATION";</div>
            <div class="text-slate-800">}</div>
          </div>
        </div>
        
        <div>
          <h3 class="text-lg font-medium text-slate-700 mb-3">UI äº¤äº’ç®€åŒ–</h3>
          <ul class="text-sm text-slate-600 space-y-2">
            <li>â€¢ ç§»é™¤å¤æ‚çš„äºŒæ¬¡ç¡®è®¤æµç¨‹</li>
            <li>â€¢ ç§»é™¤æ‰‹åŠ¨è¾“å…¥ç¡®è®¤æ–‡æœ¬</li>
            <li>â€¢ è¿ç§»åˆå¹¶åœºæ™¯ç›´æ¥é˜»æ­¢</li>
            <li>â€¢ å…¨æ–°è¿ç§»åœºæ™¯æ— éœ€é¢å¤–ç¡®è®¤</li>
            <li>â€¢ ç»Ÿä¸€çš„å¤‡ä»½ä¸‹è½½å…¥å£</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: 'base',
      themeVariables: {
        background: '#ffffff',
        primaryColor: '#ffffff',
        primaryTextColor: '#333333',
        primaryBorderColor: '#666666',
        lineColor: '#666666',
        secondaryColor: '#f8f9fa',
        tertiaryColor: '#ffffff',
        fontFamily: 'Segoe UI, Tahoma, Geneva, Verdana, sans-serif',
        fontSize: '13px'
      },
      flowchart: {
        nodeSpacing: 50,
        rankSpacing: 70,
        curve: 'basis',
        padding: 12
      }
    });
  </script>
</body>
</html>