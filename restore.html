<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ä¼˜åŒ–åçš„ Controller Restore æµç¨‹å›¾</title>

  <!-- TailwindCSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Ant Design CSS -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/antd/5.12.8/antd.min.css" rel="stylesheet">

  <!-- Mermaid -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.6.1/mermaid.min.js"></script>
</head>
<body class="bg-gray-50 text-gray-800">
  <div class="max-w-7xl mx-auto p-6">
    <h1 class="text-2xl md:text-3xl font-semibold text-slate-800 text-center mb-6">ä¼˜åŒ–åçš„ Controller Restore æµç¨‹å›¾</h1>
    <p class="text-center text-slate-600 mb-8">åŸºäºåŠ å¯†æ–‡ä»¶æ— æ³•å‰ç«¯é¢„è§£æçš„æŠ€æœ¯çº¦æŸï¼Œé‡‡ç”¨åç«¯æ™ºèƒ½æ£€æµ‹ä¸æ‹¦æˆªæœºåˆ¶</p>

    <!-- æµç¨‹å›¾ -->
    <div class="bg-white rounded-xl border border-slate-200 shadow-sm p-4 md:p-6">
      <div class="mermaid">
        flowchart TD
            Start([ç”¨æˆ·ç‚¹å‡» Restore]) --> Upload[é€‰æ‹©å¹¶ä¸Šä¼ å¤‡ä»½æ–‡ä»¶]
            Upload --> Warning[é€šç”¨é£é™©æç¤ºå¼¹çª—]
            Warning --> BackupOption[æä¾›å¿«æ·å¤‡ä»½é€‰é¡¹]
            BackupOption --> UserChoice{ç”¨æˆ·é€‰æ‹©}
            UserChoice -->|ä¸‹è½½å¤‡ä»½| Download[ä¸‹è½½å½“å‰é…ç½®]
            UserChoice -->|è·³è¿‡å¤‡ä»½| Continue[ç»§ç»­ Restore]
            Download --> Continue
            UserChoice -->|å–æ¶ˆ| Cancel([å–æ¶ˆæ“ä½œ])
            
            Continue --> ServerProcess[åç«¯è§£å¯†å¹¶è§£ææ–‡ä»¶]
            ServerProcess --> ParseCheck{æ–‡ä»¶è§£æçŠ¶æ€}
            ParseCheck -->|è§£æå¤±è´¥| ParseError[æ˜¾ç¤ºè§£æé”™è¯¯]
            ParseError --> Cancel
            
            ParseCheck -->|è§£ææˆåŠŸ| IDCheck[Controller ID æ¯”å¯¹]
            IDCheck --> RiskAssess{é£é™©è¯„ä¼°}
            
            RiskAssess -->|ç›¸åŒController| SafeRestore[æ‰§è¡Œå®‰å…¨æ¢å¤]
            SafeRestore --> SafeProgress[æ˜¾ç¤ºæ¢å¤è¿›åº¦]
            SafeProgress --> Complete([æ“ä½œå®Œæˆ])
            
            RiskAssess -->|ä¸åŒController<br/>ä¸”æœ‰ç®¡ç†è®¾å¤‡| Interrupt[ğŸš¨ ä¸­æ–­è¿›ç¨‹]
            Interrupt --> StrongWarning[å¼ºé£é™©è­¦å‘Šé¡µé¢]
            StrongWarning --> DeviceInfo[æ˜¾ç¤ºè®¾å¤‡æ•°é‡å’Œå½±å“]
            DeviceInfo --> TextInput[è¦æ±‚æ‰‹åŠ¨è¾“å…¥ç¡®è®¤æ–‡æœ¬]
            TextInput --> Verify[éªŒè¯ç¡®è®¤æ–‡æœ¬]
            Verify --> TextMatch{æ–‡æœ¬åŒ¹é…?}
            TextMatch -->|ä¸åŒ¹é…| Retry[é‡æ–°è¾“å…¥æç¤º]
            Retry --> TextInput
            TextMatch -->|åŒ¹é…| FinalConfirm[æœ€ç»ˆç¡®è®¤é¡µé¢]
            FinalConfirm --> FinalDecision{ç”¨æˆ·æœ€ç»ˆç¡®è®¤?}
            FinalDecision -->|æ˜¯| DangerousRestore[æ‰§è¡Œå±é™©è¿ç§»]
            FinalDecision -->|å¦| Cancel
            
            RiskAssess -->|ä¸åŒController<br/>ä½†æ— ç®¡ç†è®¾å¤‡| LowRisk[ä½é£é™©è¿ç§»æç¤º]
            LowRisk --> SimpleConfirm[ç®€å•äºŒæ¬¡ç¡®è®¤]
            SimpleConfirm --> SimpleDecision{ç”¨æˆ·ç¡®è®¤?}
            SimpleDecision -->|æ˜¯| SafeMigration[æ‰§è¡Œå®‰å…¨è¿ç§»]
            SimpleDecision -->|å¦| Cancel
            
            DangerousRestore --> DangerProgress[æ˜¾ç¤ºè¿ç§»è¿›åº¦]
            SafeMigration --> SafeProgress
            DangerProgress --> Complete
            
            classDef safe fill:#e8f5e8,stroke:#4caf50,stroke-width:2px
            classDef warning fill:#fff3cd,stroke:#ffc107,stroke-width:2px
            classDef danger fill:#f8d7da,stroke:#dc3545,stroke-width:2px
            classDef process fill:#e3f2fd,stroke:#2196f3,stroke-width:2px
            classDef decision fill:#f3e5f5,stroke:#9c27b0,stroke-width:2px
            classDef startEnd fill:#e1f5fe,stroke:#0277bd,stroke-width:3px
            
            class SafeRestore,SafeProgress,SafeMigration safe
            class Warning,BackupOption,LowRisk,SimpleConfirm warning
            class Interrupt,StrongWarning,DeviceInfo,TextInput,DangerousRestore,DangerProgress danger
            class ServerProcess,IDCheck,Verify process
            class UserChoice,ParseCheck,RiskAssess,TextMatch,FinalDecision,SimpleDecision decision
            class Start,Cancel,Complete startEnd
      </div>
    </div>

    <!-- æµç¨‹è¯´æ˜ -->
    <div class="mt-6">
      <h3 class="text-slate-700 font-medium mb-3">æµç¨‹é˜¶æ®µè¯´æ˜</h3>
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3">
        <!-- å®‰å…¨æ“ä½œ -->
        <div class="flex items-start gap-3 rounded-lg border border-slate-200 bg-slate-50 p-3">
          <div class="w-5 h-5 rounded-sm border border-slate-300" style="background-color:#e8f5e8"></div>
          <div class="min-w-0">
            <div class="text-sm font-semibold text-slate-800">å®‰å…¨æ“ä½œ</div>
            <div class="text-xs text-slate-500 leading-snug">ç›¸åŒControlleræˆ–æ— è®¾å¤‡å½±å“</div>
          </div>
        </div>
        <!-- é€šç”¨è­¦å‘Š -->
        <div class="flex items-start gap-3 rounded-lg border border-slate-200 bg-slate-50 p-3">
          <div class="w-5 h-5 rounded-sm border border-slate-300" style="background-color:#fff3cd"></div>
          <div class="min-w-0">
            <div class="text-sm font-semibold text-slate-800">é€šç”¨è­¦å‘Š</div>
            <div class="text-xs text-slate-500 leading-snug">å‰ç«¯ç»Ÿä¸€é£é™©æç¤º</div>
          </div>
        </div>
        <!-- é«˜å±æ“ä½œ -->
        <div class="flex items-start gap-3 rounded-lg border border-slate-200 bg-slate-50 p-3">
          <div class="w-5 h-5 rounded-sm border border-slate-300" style="background-color:#f8d7da"></div>
          <div class="min-w-0">
            <div class="text-sm font-semibold text-slate-800">é«˜å±æ“ä½œ</div>
            <div class="text-xs text-slate-500 leading-snug">è·¨Controllerä¸”æœ‰ç®¡ç†è®¾å¤‡</div>
          </div>
        </div>
        <!-- åç«¯å¤„ç† -->
        <div class="flex items-start gap-3 rounded-lg border border-slate-200 bg-slate-50 p-3">
          <div class="w-5 h-5 rounded-sm border border-slate-300" style="background-color:#e3f2fd"></div>
          <div class="min-w-0">
            <div class="text-sm font-semibold text-slate-800">åç«¯å¤„ç†</div>
            <div class="text-xs text-slate-500 leading-snug">è§£å¯†åˆ†æä¸æ™ºèƒ½æ£€æµ‹</div>
          </div>
        </div>
        <!-- å†³ç­–èŠ‚ç‚¹ -->
        <div class="flex items-start gap-3 rounded-lg border border-slate-200 bg-slate-50 p-3">
          <div class="w-5 h-5 rounded-sm border border-slate-300" style="background-color:#f3e5f5"></div>
          <div class="min-w-0">
            <div class="text-sm font-semibold text-slate-800">å†³ç­–èŠ‚ç‚¹</div>
            <div class="text-xs text-slate-500 leading-snug">ç”¨æˆ·é€‰æ‹©ä¸ç³»ç»Ÿåˆ¤æ–­</div>
          </div>
        </div>
      </div>
    </div>

    <!-- ç¬¬ä¸€é˜¶æ®µï¼šé€šç”¨é£é™©æç¤º -->
    <div class="mt-10 rounded-xl border border-slate-200 bg-white p-5 md:p-6">
      <h2 class="text-xl font-semibold text-slate-800 mb-4">ç¬¬ä¸€é˜¶æ®µï¼šé€šç”¨é£é™©æç¤ºå¼¹çª—</h2>

      <div class="bg-slate-50 rounded-lg p-6 md:p-8">
        <div class="flex justify-center items-center">
          <div class="relative w-[680px] max-w-[92vw] bg-white rounded-lg shadow-xl border border-slate-200">
            <!-- Header -->
            <div class="px-5 py-3 border-b border-slate-100 flex items-center gap-3">
              <div class="text-xl">âš ï¸</div>
              <h3 class="m-0 text-base font-semibold text-orange-600">Configuration Restore Warning</h3>
            </div>

            <!-- Body -->
            <div class="p-5">
              <!-- è­¦ç¤ºä¿¡æ¯ -->
              <div class="rounded-md border border-orange-200 bg-orange-50 p-4 mb-4">
                <p class="m-0 text-sm font-medium text-orange-800 mb-2">
                  You are about to restore a configuration backup. This operation will:
                </p>
                <ul class="mt-2 text-sm text-orange-800 space-y-1 ml-4">
                  <li>â€¢ Overwrite current controller configuration</li>
                  <li>â€¢ Potentially affect managed devices</li>
                  <li>â€¢ Cannot be undone without a backup</li>
                </ul>
              </div>

              <!-- å¤‡ä»½æ¨è -->
              <div class="rounded-md border border-blue-200 bg-blue-50 p-4">
                <div class="flex items-center gap-2 mb-3 text-blue-700 text-sm font-medium">
                  <span>ğŸ’¾</span><span>Recommended: Download current backup first</span>
                </div>
                <button
                  class="ant-btn ant-btn-primary w-full mb-2 inline-flex items-center justify-center gap-2 rounded-md shadow-sm
                         bg-blue-600 text-white border border-blue-600 hover:bg-blue-500 hover:border-blue-500
                         focus:outline-none focus:ring-2 focus:ring-blue-400 h-10"
                >
                  <span class="text-base">ğŸ“¥</span>
                  <span>Download Current Backup</span>
                </button>
                <p class="m-0 text-xs text-slate-500 text-center">Save current configuration before proceeding</p>
              </div>
            </div>

            <!-- Footer -->
            <div class="px-5 py-3 border-t border-slate-100 flex justify-end gap-2">
              <button
                class="ant-btn ant-btn-default inline-flex items-center justify-center px-4 py-2 rounded-md
                       border border-slate-300 bg-white text-slate-700 shadow-sm
                       hover:bg-slate-50 hover:border-slate-400
                       focus:outline-none focus:ring-2 focus:ring-blue-400"
              >
                Cancel
              </button>

              <button
                class="ant-btn ant-btn-default inline-flex items-center justify-center px-4 py-2 rounded-md
                       border border-slate-300 bg-white text-slate-700 shadow-sm
                       hover:bg-slate-50 hover:border-slate-400
                       focus:outline-none focus:ring-2 focus:ring-blue-400"
              >
                Skip Backup
              </button>

              <button
                class="ant-btn ant-btn-primary inline-flex items-center justify-center px-4 py-2 rounded-md
                       border border-orange-600 bg-orange-600 text-white shadow-sm
                       hover:bg-orange-500 hover:border-orange-500
                       focus:outline-none focus:ring-2 focus:ring-orange-400"
              >
                Continue Restore
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ç¬¬äºŒé˜¶æ®µï¼šå¼ºé£é™©è­¦å‘Šï¼ˆè·¨Controller + æœ‰ç®¡ç†è®¾å¤‡ï¼‰ -->
    <div class="mt-10 rounded-xl border border-slate-200 bg-white p-5 md:p-6">
      <h2 class="text-xl font-semibold text-slate-800 mb-4">ç¬¬äºŒé˜¶æ®µï¼šå¼ºé£é™©è­¦å‘Šå¼¹çª—ï¼ˆåç«¯æ£€æµ‹è§¦å‘ï¼‰</h2>

      <div class="bg-slate-50 rounded-lg p-6 md:p-8">
        <div class="flex justify-center items-center">
          <div class="relative w-[800px] max-w-[92vw] bg-white rounded-lg shadow-2xl border border-red-200">
            <!-- Header -->
            <div class="px-5 py-3 border-b border-red-100 flex items-center gap-3 bg-red-50">
              <div class="text-xl">ğŸš¨</div>
              <h3 class="m-0 text-base font-semibold text-red-600">Critical Migration Warning</h3>
            </div>

            <!-- Body -->
            <div class="p-5">
              <!-- å±é™©è­¦å‘Š -->
              <div class="rounded-md border border-red-300 bg-red-50 p-4 mb-4">
                <div class="flex items-start gap-3">
                  <div class="text-red-500 text-lg mt-0.5">âš ï¸</div>
                  <div>
                    <p class="m-0 text-sm font-bold text-red-800 mb-2">DANGER: Cross-Controller Migration Detected</p>
                    <div class="text-sm text-red-700 space-y-1">
                      <div>â€¢ <strong>Source:</strong> Controller-AAA-1234</div>
                      <div>â€¢ <strong>Target:</strong> Controller-BBB-5678</div>
                      <div>â€¢ <strong>Impact:</strong> This will FORGET all <strong class="text-red-800">23 currently managed devices</strong></div>
                      <div>â€¢ <strong>Result:</strong> Immediate network disruption will occur</div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- æ‰‹åŠ¨ç¡®è®¤è¾“å…¥ -->
              <div class="rounded-md border border-slate-300 p-4 bg-slate-50">
                <label for="confirmText" class="block mb-3 text-sm font-medium text-slate-700">
                  To proceed, type the following text exactly (case-sensitive):
                </label>

                <div class="rounded-md border border-dashed border-slate-400 bg-white px-3 py-3 text-center font-mono text-sm text-slate-800 mb-3 select-all border-2">
                  I understand the risks and confirm migration
                </div>

                <input
                  id="confirmTextDanger"
                  type="text"
                  autocomplete="off"
                  spellcheck="false"
                  class="ant-input w-full mb-3 rounded-md border border-slate-300 bg-white text-slate-800 h-11 px-3 text-sm
                         placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-red-400 focus:border-red-500"
                  placeholder="Type the confirmation text exactly as shown above"
                />

                <div id="confirmStatusDanger" class="text-xs text-slate-500 flex items-center gap-2">
                  <span class="w-2 h-2 rounded-full bg-slate-400"></span>
                  <span>Text verification pending</span>
                </div>
              </div>
            </div>

            <!-- Footer -->
            <div class="px-5 py-3 border-t border-slate-100 flex justify-end gap-2">
              <button
                class="ant-btn ant-btn-default inline-flex items-center justify-center px-4 py-2 rounded-md
                       border border-slate-300 bg-white text-slate-700 shadow-sm
                       hover:bg-slate-50 hover:border-slate-400
                       focus:outline-none focus:ring-2 focus:ring-blue-400"
              >
                Cancel Migration
              </button>

              <button
                class="ant-btn ant-btn-primary ant-btn-dangerous inline-flex items-center justify-center px-4 py-2 rounded-md
                       border border-red-600 bg-red-600 text-white shadow-sm
                       hover:bg-red-500 hover:border-red-500
                       focus:outline-none focus:ring-2 focus:ring-red-400
                       disabled:bg-slate-200 disabled:border-slate-300 disabled:text-slate-400"
                id="btnConfirmDangerMigration"
                disabled
              >
                Confirm Migration
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ç¬¬ä¸‰é˜¶æ®µï¼šä½é£é™©è¿ç§»æç¤ºï¼ˆè·¨Controllerä½†æ— ç®¡ç†è®¾å¤‡ï¼‰ -->
    <div class="mt-10 rounded-xl border border-slate-200 bg-white p-5 md:p-6">
      <h2 class="text-xl font-semibold text-slate-800 mb-4">ç¬¬ä¸‰é˜¶æ®µï¼šä½é£é™©è¿ç§»æç¤ºï¼ˆæ— ç®¡ç†è®¾å¤‡åœºæ™¯ï¼‰</h2>

      <div class="bg-slate-50 rounded-lg p-6 md:p-8">
        <div class="flex justify-center items-center">
          <div class="relative w-[600px] max-w-[92vw] bg-white rounded-lg shadow-lg border border-slate-200">
            <!-- Header -->
            <div class="px-5 py-3 border-b border-slate-100 flex items-center gap-3">
              <div class="text-xl">â„¹ï¸</div>
              <h3 class="m-0 text-base font-semibold text-blue-600">Cross-Controller Migration</h3>
            </div>

            <!-- Body -->
            <div class="p-5">
              <!-- ä¿¡æ¯æç¤º -->
              <div class="rounded-md border border-blue-200 bg-blue-50 p-4 mb-4">
                <p class="m-0 text-sm font-medium text-blue-800 mb-2">
                  Migrating configuration between different controllers:
                </p>
                <div class="text-sm text-blue-700 space-y-1">
                  <div>â€¢ <strong>Source:</strong> Controller-AAA-1234</div>
                  <div>â€¢ <strong>Target:</strong> Controller-BBB-5678</div>
                  <div>â€¢ <strong>Status:</strong> No managed devices detected</div>
                  <div>â€¢ <strong>Impact:</strong> Configuration will be safely migrated</div>
                </div>
              </div>

              <p class="text-sm text-slate-600">
                Since there are no currently managed devices, this migration poses minimal risk. 
                The configuration will be applied to the current controller.
              </p>
            </div>

            <!-- Footer -->
            <div class="px-5 py-3 border-t border-slate-100 flex justify-end gap-2">
              <button
                class="ant-btn ant-btn-default inline-flex items-center justify-center px-4 py-2 rounded-md
                       border border-slate-300 bg-white text-slate-700 shadow-sm
                       hover:bg-slate-50 hover:border-slate-400
                       focus:outline-none focus:ring-2 focus:ring-blue-400"
              >
                Cancel
              </button>

              <button
                class="ant-btn ant-btn-primary inline-flex items-center justify-center px-4 py-2 rounded-md
                       border border-blue-600 bg-blue-600 text-white shadow-sm
                       hover:bg-blue-500 hover:border-blue-500
                       focus:outline-none focus:ring-2 focus:ring-blue-400"
              >
                Confirm Migration
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: 'base',
      themeVariables: {
        background: '#ffffff',
        primaryColor: '#ffffff',
        primaryTextColor: '#333333',
        primaryBorderColor: '#666666',
        lineColor: '#666666',
        secondaryColor: '#f8f9fa',
        tertiaryColor: '#ffffff',
        fontFamily: 'Segoe UI, Tahoma, Geneva, Verdana, sans-serif',
        fontSize: '13px'
      },
      flowchart: {
        nodeSpacing: 50,
        rankSpacing: 70,
        curve: 'basis',
        padding: 12
      }
    });
  </script>
  <script>
    // å±é™©ç¡®è®¤æ–‡æœ¬éªŒè¯
    (function () {
      const REQUIRED_TEXT = 'I understand the risks and confirm migration';
      const input = document.getElementById('confirmTextDanger');
      const status = document.getElementById('confirmStatusDanger');
      const confirmBtn = document.getElementById('btnConfirmDangerMigration');

      if (!input || !status || !confirmBtn) return;

      function updateState() {
        const val = (input.value || '').trim();
        if (!val) {
          status.innerHTML = '<span class="w-2 h-2 rounded-full bg-slate-400"></span><span>Text verification pending</span>';
          confirmBtn.disabled = true;
          return;
        }
        if (val === REQUIRED_TEXT) {
          status.innerHTML = '<span class="w-2 h-2 rounded-full bg-green-500"></span><span class="text-green-600">âœ… Text matched</span>';
          confirmBtn.disabled = false;
        } else {
          status.innerHTML = '<span class="w-2 h-2 rounded-full bg-red-500"></span><span class="text-red-600">âŒ Text does not match</span>';
          confirmBtn.disabled = true;
        }
      }

      input.addEventListener('input', updateState);
      updateState();
    })();
  </script>
</body>
</html>